# ğŸ½ï¸ Let's Eat

**Let's Eat**ëŠ” ì•„ë™ê¸‰ì‹ì¹´ë“œë¥¼ í™œìš©í•œ ë§ˆì„ íƒí—˜ ê²Œì„í˜• ì‹ì‚¬ ì˜ˆì•½ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.  
MSA(Microservices Architecture) ê¸°ë°˜ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ë…ë¦½ì ìœ¼ë¡œ ë°°í¬ ë° í™•ì¥ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
SpringBoot ê¸°ë°˜ ë°±ì—”ë“œ ë ˆí¬ì§€í† ë¦¬ì…ë‹ˆë‹¤.

<div align="center">
<img width="70%" src="https://github.com/user-attachments/assets/ece2f279-d183-42fb-97d2-0faf97c1178e" />
</div>

## ğŸ›  Tech Stack
<img src="https://skillicons.dev/icons?i=spring,mysql,redis,docker,kubernetes,github" height="50">

---

## ğŸ“š ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ì†Œê°œ](#-í”„ë¡œì íŠ¸-ì†Œê°œ)  
2. [ê¸°ìˆ  ìŠ¤íƒ](#-ê¸°ìˆ -ìŠ¤íƒ)  
3. [íŒ€ì› ì†Œê°œ](#-íŒ€ì›-ì†Œê°œ)  
4. [ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜](#-ì„œë¹„ìŠ¤-ì•„í‚¤í…ì²˜)  
5. [í”„ë¡œì íŠ¸ êµ¬ì¡°](#-í”„ë¡œì íŠ¸-êµ¬ì¡°)
6. [ì¿ ë²„ë„¤í‹°ìŠ¤ ì„¤ì •](#-ì¿ ë²„ë„¤í‹°ìŠ¤-ì„¤ì •) 
7. [ì„œë¹„ìŠ¤ ê°„ í†µì‹ ](#-ì„œë¹„ìŠ¤-ê°„-í†µì‹ )  
8. [CI/CD íŒŒì´í”„ë¼ì¸](#-cicd-íŒŒì´í”„ë¼ì¸)  
9. [MSA ì•„í‚¤í…ì²˜](#-msa-ì•„í‚¤í…ì²˜)

---

## ğŸ“– í”„ë¡œì íŠ¸ ì†Œê°œ

**Let's Eat**ëŠ” ì•„ë™ê¸‰ì‹ì¹´ë“œ ì‚¬ìš©ì˜ ì ‘ê·¼ì„±ì„ ë†’ì´ê³ , ì˜ì–‘ ê· í˜• ê´€ë¦¬ë¥¼ ê²Œì„í™”í•˜ì—¬ ì•„ì´ë“¤ì´ ì¦ê²ê²Œ ì‹ì‚¬í•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.  

**ì£¼ìš” íŠ¹ì§•**
- ê²Œì„í˜• ë§ˆì„ ì¸í„°í˜ì´ìŠ¤ë¡œ ì§ê´€ì ì¸ ê°€ê²Œ íƒìƒ‰  
- ë””ì§€í„¸ ì´ˆëŒ€ì¥ ì‹œìŠ¤í…œìœ¼ë¡œ ì˜¤í”„ë¼ì¸ ê²°ì œ ê°„ì†Œí™”  
- OpenFeign ê¸°ë°˜ ì„œë¹„ìŠ¤ ê°„ ë™ê¸° í†µì‹   
- Kubernetes í™˜ê²½ì—ì„œì˜ ì•ˆì •ì ì¸ MSA ìš´ì˜

<div align="center">

<img width="70%" src="https://github.com/user-attachments/assets/ea465397-9bd9-4470-bad5-e659abb6119e" />

<img width="70%" src="https://github.com/user-attachments/assets/06bfded3-65e0-43c2-b09a-330b5e7b976e" />

<img width="70%" src="https://github.com/user-attachments/assets/1fb615af-8b7d-4175-b229-a7132131f103" />

<img width="70%" src="https://github.com/user-attachments/assets/d9dde671-4c44-41b5-99ba-cdbe3260de84" />

<img width="70%" src="https://github.com/user-attachments/assets/42adc30d-b362-4775-9083-75e66cf61f98" />

<img width="70%" src="https://github.com/user-attachments/assets/9160caa2-81f0-40cd-a077-9394332363c2" />

<img width="70%" src="https://github.com/user-attachments/assets/77883950-92dd-4a0d-93eb-3063ba1338c0" />

<img width="70%" src="https://github.com/user-attachments/assets/52c3f07e-9f64-4cac-803e-13ab4fc5b890" />

<img width="70%" src="https://github.com/user-attachments/assets/41a3a404-3c74-41f2-ab85-9bb383f965a9" />

<img width="70%" src="https://github.com/user-attachments/assets/f20e5aba-1bf1-4723-8f46-da6d69825565" />

<img width="70%" src="https://github.com/user-attachments/assets/d6d668aa-18dd-43df-8873-fd62ceb71f30" />

<img width="70%" src="https://github.com/user-attachments/assets/e929580e-9aac-4c48-8bd0-b2673106dbb2" />

<img width="70%" src="https://github.com/user-attachments/assets/9b8c717f-7cd6-4a84-823e-0615d0a97574" />

<img width="70%" src="https://github.com/user-attachments/assets/eb1f296b-6872-423e-a983-cd6ab14e4a22" />

<img width="70%" src="https://github.com/user-attachments/assets/f0afe463-212c-47a8-9a88-05912fb385af" />

<img width="70%" src="https://github.com/user-attachments/assets/cd735592-df96-40f0-8e6c-30c60c70abfe" />

<img width="70%" src="https://github.com/user-attachments/assets/29ed7149-4078-49ec-aab5-c1e4b589842d" />

</div>

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

| êµ¬ë¶„ | ê¸°ìˆ  |
|------|------|
| **Language** | Java |
| **Framework** | Spring Boot, Spring Cloud |
| **Database** | MySQL, Redis |
| **Infra** | Docker, Kubernetes(NKS), Naver Cloud Platform |
| **CI/CD** | NCP SourceCommit, SourceBuild, SourceDeploy, SourcePipeline |
| **Auth** | JWT, Spring Security |
| **Communication** | OpenFeign |
| **ì™¸ë¶€ API** | Google Vision API, NCP Object Storage |

---

## ğŸ‘¤ íŒ€ì› ì†Œê°œ

<div align="center">

| Team Member | Team Member |
|:---------------------------------------------------------------------:|:-------------------------------------------------------------------:|
| <img src="https://github.com/JiwonLee42.png" width="200" /> | <img src="https://github.com/2anizirong.png" width="200" /> |
| [ì´ì§€ì›](https://github.com/JiwonLee42) | [ê¹€ì´ì•ˆ](https://github.com/2anizirong) |
| â€¢ User/Pay Service ê°œë°œ<br>â€¢ Gateway Service/JWT ì¸ì¦ êµ¬í˜„<br>â€¢ NKS í´ëŸ¬ìŠ¤í„° êµ¬ì„± ë° K8S ë¦¬ì†ŒìŠ¤ ê´€ë¦¬<br>â€¢ CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶• | â€¢ Store/Review Service ê°œë°œ<br>â€¢ OpenFeign í†µì‹  êµ¬í˜„<br>â€¢ NCP Object Storage ì—°ë™<br> |

</div>

---

## ğŸ–¥ ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜

<div align="center">
<img width="90%" src="https://github.com/user-attachments/assets/f8d583da-ce49-42ee-83db-6e8f4031142d" />
</div>

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
```plaintext
pairmate_backend/
â”œâ”€â”€ common-libs/                    # ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬
â”œâ”€â”€ config-server/                  # Config Server
â”œâ”€â”€ eureka-server/                  # Eureka Server
â”œâ”€â”€ gateway-service/                # API Gateway
â”œâ”€â”€ user-service/                   # User Service
â”œâ”€â”€ store-service/                  # Store Service
â”œâ”€â”€ pay-service/                    # Pay Service
â”œâ”€â”€ review-service/                 # Review Service
â”‚
â””â”€â”€ k8s/                            # Kubernetes ë¦¬ì†ŒìŠ¤
    â”œâ”€â”€ namespace.yaml
    â”œâ”€â”€ cert/                       # TLS ì¸ì¦ì„œ
    â”œâ”€â”€ configmap/                  # í™˜ê²½ ì„¤ì •
    â”œâ”€â”€ secret/                     # ë¯¼ê° ì •ë³´
    â”œâ”€â”€ db/                         # MySQL
    â”œâ”€â”€ redis/                      # Redis
    â”œâ”€â”€ deployment/                 # ì„œë¹„ìŠ¤ ë°°í¬
    â”œâ”€â”€ frontend/                   # Frontend
    â””â”€â”€ ingress/                    # ë¼ìš°íŒ…
```

---

## â˜¸ï¸ ì¿ ë²„ë„¤í‹°ìŠ¤ ì„¤ì •

### 1. ë„¤ì„ìŠ¤í˜ì´ìŠ¤

| í™˜ê²½ | ë„¤ì„ìŠ¤í˜ì´ìŠ¤ | ìš©ë„ |
|------|-------------|------|
| í…ŒìŠ¤íŠ¸ | `pairmate-test` | ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½ |
| ìš´ì˜ | `pairmate-prod` | í”„ë¡œë•ì…˜ í™˜ê²½ |
```bash
kubectl create namespace pairmate-test
kubectl create namespace pairmate-prod
```

---

### 2. Secret

| Secret ì´ë¦„ | ë‚´ìš© |
|-------------|------|
| `ncr-secret` | NCR ì´ë¯¸ì§€ Pull ì¸ì¦ |
| `config-git-secret` | Config Server Git ì¸ì¦ |
| `redis-secret` | Redis ë¹„ë°€ë²ˆí˜¸ |
| `*-db-secret` | ê° ì„œë¹„ìŠ¤ DB ê³„ì • ì •ë³´ |
| `pay-pg-secret` | ê²°ì œ API í‚¤ |
```bash
kubectl apply -f k8s/secret/ -n pairmate-prod
```

---

### 3. ConfigMap

| ConfigMap ì´ë¦„ | ë‚´ìš© |
|---------------|------|
| `global-config` | Config Server URL, ê³µí†µ í™˜ê²½ ë³€ìˆ˜ |
| `nginx-config` | Nginx ì„¤ì • (API í”„ë¡ì‹œ) |
```bash
kubectl apply -f k8s/configmap/ -n pairmate-prod
```

---

### 4. ì¸ì¦ì„œ ë° Ingress

| í•­ëª© | ì„¤ì • |
|------|------|
| **ì¸ì¦ì„œ** | Let's Encrypt (ìë™ ê°±ì‹ ) |
| **ìš´ì˜ ë„ë©”ì¸** | lets-eat.store |
| **í…ŒìŠ¤íŠ¸ ë„ë©”ì¸** | test.lets-eat.store |
| **TLS** | TLS 1.3 |

**ê²½ë¡œë³„ ë¼ìš°íŒ…**

| ê²½ë¡œ | ì„œë¹„ìŠ¤ |
|------|--------|
| `/` | frontend-service |
| `/api/auth` | user-service |
| `/api/stores` | store-service |
| `/api/review` | review-service |
| `/api/pay` | pay-service |

---

### 5. ìš´ì˜ í™˜ê²½

| êµ¬ì„± ìš”ì†Œ | ì„¤ì • |
|----------|------|
| **í”Œë«í¼** | Naver Cloud Kubernetes Service (NKS) |
| **ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬** | Naver Container Registry (NCR) |
| **ìŠ¤í† ë¦¬ì§€** | ncloud-block-storage |
| **ë¡œë“œë°¸ëŸ°ì„œ** | NCP Load Balancer |

---

### 6. ë°°í¬ ì „ëµ

| ì „ëµ | ë‚´ìš© |
|------|------|
| **Rolling Update** | ë¬´ì¤‘ë‹¨ ë°°í¬, ìƒˆ ë²„ì „ ê¸°ë™ í™•ì¸ í›„ ì „í™˜ |
| **Topology Spread** | Pod ë…¸ë“œ ê°„ ê· ë“± ë¶„ì‚° |
| **Startup Probe** | ì´ˆê¸° êµ¬ë™ ì‹œê°„ í™•ë³´ |
| **Readiness Probe** | íŠ¸ë˜í”½ ìˆ˜ì‹  ì¤€ë¹„ í™•ì¸ |
| **Liveness Probe** | ë¹„ì •ìƒ Pod ìë™ ì¬ì‹œì‘ |

---

### 7. ë°°í¬ ëª…ë ¹
```bash
# DB ë° Redis ë°°í¬
kubectl apply -f k8s/db/ -n pairmate-prod
kubectl apply -f k8s/redis/ -n pairmate-prod

# ì„œë¹„ìŠ¤ ë°°í¬
kubectl apply -f k8s/deployment/ -n pairmate-prod

# ë°°í¬ ìƒíƒœ í™•ì¸
kubectl rollout status deployment/<ì„œë¹„ìŠ¤ëª…> -n pairmate-prod
```

---

## ğŸ”— ì„œë¹„ìŠ¤ ê°„ í†µì‹ 

### OpenFeign ê¸°ë°˜ ë™ê¸° í†µì‹ 

| ìˆœì„œ | ë‹¨ê³„ | ì„¤ëª… |
|------|------|------|
| 1 | **ë©”ì„œë“œ í˜¸ì¶œ** | A ì„œë¹„ìŠ¤ì—ì„œ FeignClient ì¸í„°í˜ì´ìŠ¤ ë©”ì„œë“œ í˜¸ì¶œ |
| 2 | **í˜¸ì¶œ ê°€ë¡œì±„ê¸°** | OpenFeignì´ `@FeignClient` ì •ë³´ í™•ì¸ |
| 3 | **ì„œë¹„ìŠ¤ íƒìƒ‰** | Eureka Serverì—ì„œ B ì„œë¹„ìŠ¤ IP/í¬íŠ¸ ì¡°íšŒ |
| 4 | **HTTP ìš”ì²­ ìƒì„±** | ë©”ì„œë“œ ë§¤í•‘ ì •ë³´ ê¸°ë°˜ HTTP ìš”ì²­ ìƒì„± |
| 5 | **ìš”ì²­ ì „ì†¡** | B ì„œë¹„ìŠ¤ë¡œ ìš”ì²­ ì „ì†¡ ë° JSON ì‘ë‹µ ìˆ˜ì‹  |
| 6 | **ìë™ ë³€í™˜** | JSON â†’ ResponseDto ê°ì²´ ìë™ ë³€í™˜ |

**ì£¼ìš” íŠ¹ì§•**
- ì„œë¹„ìŠ¤ëª… ê¸°ë°˜ í†µì‹  (IP í•˜ë“œì½”ë”© ë¶ˆí•„ìš”)
- ìë™ ë¡œë“œ ë°¸ëŸ°ì‹±
- Circuit Breaker ì ìš©
- ì„ ì–¸ì  HTTP í´ë¼ì´ì–¸íŠ¸

---

## âš™ï¸ CI/CD íŒŒì´í”„ë¼ì¸

### NCP SourcePipeline

| ë‹¨ê³„ | ë„êµ¬ | ì—­í•  |
|------|------|------|
| **1. ì½”ë“œ ê´€ë¦¬** | SourceCommit | Git ì €ì¥ì†Œ ê´€ë¦¬, ë¸Œëœì¹˜ ì „ëµ |
| **2. ë¹Œë“œ** | SourceBuild | Docker ì´ë¯¸ì§€ ë¹Œë“œ, NCR í‘¸ì‹œ |
| **3. ë°°í¬** | SourceDeploy | NKS í´ëŸ¬ìŠ¤í„° ë°°í¬, Rolling Update |
| **4. í†µí•©** | SourcePipeline | ì „ì²´ ê³¼ì • ìë™í™” ë° ëª¨ë‹ˆí„°ë§ |

### ë°°í¬ í”„ë¡œì„¸ìŠ¤
```
ì½”ë“œ í‘¸ì‹œ â†’ Docker ë¹Œë“œ â†’ NCR ì €ì¥ â†’ K8S ë°°í¬ â†’ í—¬ìŠ¤ì²´í¬ â†’ ì„œë¹„ìŠ¤ ë°˜ì˜
```

### í™˜ê²½ ë¶„ë¦¬

| í™˜ê²½ | ë„¤ì„ìŠ¤í˜ì´ìŠ¤ | ë„ë©”ì¸ |
|------|-------------|--------|
| í…ŒìŠ¤íŠ¸ | pairmate-test | test.lets-eat.store |
| ìš´ì˜ | pairmate-prod | lets-eat.store |

---

## ğŸ— MSA ì•„í‚¤í…ì²˜

### í•µì‹¬ ì¸í”„ë¼

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  |
|---------|------|
| **Eureka Server** | ì„œë¹„ìŠ¤ ë“±ë¡/íƒìƒ‰, ë™ì  ë¼ìš°íŒ… |
| **Config Server** | ì¤‘ì•™ ì„¤ì • ê´€ë¦¬, í™˜ê²½ë³„ ì„¤ì • ë¶„ë¦¬ |
| **Gateway Service** | JWT ì¸ì¦, CORS ì²˜ë¦¬, ë¼ìš°íŒ…, ë¡œê¹… |
| **Common Libs** | ê³µí†µ ì‘ë‹µ/ì˜ˆì™¸ êµ¬ì¡°, JWT ìœ í‹¸ |

---

### Application ì„œë¹„ìŠ¤

| ì„œë¹„ìŠ¤ | ì£¼ìš” ê¸°ëŠ¥ |
|--------|----------|
| **User Service** | íšŒì›ê°€ì…, ë¡œê·¸ì¸, JWT ë°œê¸‰, RefreshToken ê´€ë¦¬ |
| **Store Service** | ê°€ê²Œ ë“±ë¡/ìˆ˜ì •/ì‚­ì œ, ì¹´í…Œê³ ë¦¬ ê´€ë¦¬, ì´ë¯¸ì§€ ì—…ë¡œë“œ |
| **Review Service** | ë¦¬ë·° ì‘ì„±/ìˆ˜ì •/ì‚­ì œ, ë³„ì  ê³„ì‚°, ì´ë¯¸ì§€ ì—…ë¡œë“œ |
| **Pay Service** | ì¹´ë“œ ë“±ë¡/ê²€ì¦, ê²°ì œ ì²˜ë¦¬, í•œë„ ê´€ë¦¬ |

---

### ë³´ì•ˆ ë° ì¸ì¦

| í•­ëª© | êµ¬í˜„ |
|------|------|
| **ì¸ì¦** | JWT ê¸°ë°˜ ë¬´ìƒíƒœ ì¸ì¦ |
| **í† í° ì €ì¥** | RefreshToken â†’ Redis |
| **í†µì‹  ë³´ì•ˆ** | TLS 1.3, Let's Encrypt |
| **ë¯¼ê° ì •ë³´** | Kubernetes Secret (Base64) |
